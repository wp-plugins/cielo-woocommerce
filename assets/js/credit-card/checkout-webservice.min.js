!function(a){"use strict";a(function(){function b(){if(!a("#payment_method_cielo_credit").is(":checked"))return!0;if(1===jQuery("input.cielo-credit-card-brand").size())return!0;var b=a("form.checkout, form#order_review"),c=a("#cielo-card-number",b).val(),d=a.payment.cardType(c);return"dinersclub"===d&&(d="diners"),a("input.cielo-credit-card-brand",b).remove(),b.append(a('<input class="cielo-credit-card-brand" name="cielo_credit_card" type="hidden" />').val(d)),!0}function c(b){var c=a("#cielo-credit-payment-form #cielo-installments");a("#cielo-credit-payment-form #cielo-installments").empty(),a("#cielo-credit-payment-form #cielo-installments").prepend(a.data(document.body,"cielo_credit_installments")),"discover"===b&&a("option",c).not(".cielo-at-sight").remove()}if(a.data(document.body,"cielo_credit_installments",a("#cielo-credit-payment-form #cielo-installments").html()),a.payment.cards){var d=[];a.each(a.payment.cards,function(a,b){d.push(b.type)}),-1===a.inArray("elo",d)&&a.payment.cards.push({type:"elo",pattern:/^(636[2-3])/,format:/(\d{1,4})/g,length:[16],cvcLength:[3],luhn:!0}),-1===a.inArray("aura",d)&&a.payment.cards.unshift({type:"aura",pattern:/^5078/,format:/(\d{1,6})(\d{1,2})?(\d{1,11})?/,length:[19],cvcLength:[3],luhn:!0})}a("form.checkout").on("checkout_place_order_cielo_credit",function(){return b()}),a("form#order_review").submit(function(){return b()}),a("body").on("checkout_error",function(){a("input.cielo-credit-card-brand").remove()}),a("form.checkout, form#order_review").on("change","#cielo-credit-payment-form input",function(){a("input.cielo-credit-card-brand").remove()}),a("body").on("ajaxComplete",function(){a.data(document.body,"cielo_credit_installments",a("#cielo-credit-payment-form #cielo-installments").html()),c(a("body #cielo-credit-payment-form #cielo-card-brand option").first().val())}),a("body").on("change","#cielo-credit-payment-form #cielo-card-number",function(){c(a.payment.cardType(a(this).val()))})})}(jQuery);